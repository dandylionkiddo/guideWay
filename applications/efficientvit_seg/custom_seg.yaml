# model
model:
  name: efficientvit-seg-b0 # 1. 모델 이름을 segformer-b0로 변경

# data provider (데이터셋 설정은 그대로 유지)
data_provider:
  task: seg
  dataset: mapillary 
  data_dir: D:\AIffel\EfficientViT\data\mapillary-vistas-dataset_public_v2.0 # \demo_training
  n_classes: 19 # 새로운 클래스 수
  class_mapping_path: D:\AIffel\EfficientViT\efficientvit\applications\efficientvit_seg\custom_class_mapping.json # 클래스 매핑 파일 경로

  # SegDataProvider가 데이터셋 구조를 파악하는 데 사용하는 정보
  train_split: training
  val_split: validation
  image_dir_name: images
  label_dir_name: labels
  image_suffix: .jpg
  label_suffix: .png

  # 데이터로더 설정
  base_batch_size: 8
  test_batch_size: 8
  n_worker: 8
  image_size: 512

# run config (SegFormer에 맞게 일부 하이퍼파라미터 조절)
run_config:
  n_epochs: 500
  base_lr: 0.001
  warmup_epochs: 10
  warmup_lr: 0.0
  lr_schedule_name: cosine
  lr_schedule_param: {}
  optimizer_name: adamw
  optimizer_params:
    betas: [0.9, 0.999]
    eps: 1.0e-08
  weight_decay: 0.01
  no_wd_keys: []
  grad_clip: null
  reset_bn: false
  reset_bn_size: 0
  reset_bn_batch_size: 0
  eval_image_size: [512]
  early_stopping_patience: 10
  early_stopping_metric: val_miou 

# model init
model_init:
  rand_init: trunc_normal
  last_gamma: 0.0
#   # 사전 학습된 가중치를 사용하되, head 부분은 랜덤 초기화되므로 finetuning과 유사하게 동작
#   backbone_init_from: D:\AIffel\EfficientViT\efficientvit\efficientvit\assets\checkpoints\efficientvit_seg\efficientvit_seg_b0_cityscapes.pt
  init_from: d:\AIffel\EfficientViT\efficientvit\output\from_runpod\checkpoint.pt